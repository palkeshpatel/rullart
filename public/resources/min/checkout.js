var address_label="Address",additional_label="Additional details";function fillArea(e,a){var t=$("#area");t.empty(),t.append($("<option></option>").val("").html("Select")),$.ajax({url:base_url+"areas/getdata",data:{country:e},type:"POST",dataType:"JSON",success:function(e){"FALSE"!=e&&($.each(e,function(e,a){t.append($("<option></option>").val(a.areaid).html(a.areaname))}),$("#area").val(a).trigger("render.customSelect"))}})}function fillAreaBill(e,a){var t=$("#areaBill");t.empty(),t.append($("<option></option>").val("").html("Select")),$.ajax({url:base_url+"areas/getdata",data:{country:e},type:"POST",dataType:"JSON",success:function(e){"FALSE"!=e&&($.each(e,function(e,a){t.append($("<option></option>").val(a.areaid).html(a.areaname))}),$("#areaBill").val(a).trigger("render.customSelect"))}})}-1<window.location.href.indexOf("/ar/")&&(address_label="العنوان",additional_label="تفاصيل اخرى"),$(document).ready(function(){$("#formAddressCheckout").validate({highlight:function(e){$(e).parent().addClass("has-error")},unhighlight:function(e){$(e).parent().removeClass("has-error")},onfocusout:!1,invalidHandler:function(e,a){a.numberOfInvalids()&&a.errorList[0].element.focus()}}),$("#btnContinueShopping").on("click",function(e){location.href=base_url+"home"}),$("#btnContinue").on("click",function(e){location.href=base_url+"checkout"}),$("#chk_kuwait_delivery").on("click",function(e){$("#divCheckboxMessage").hide()}),$("#btnProceedPayment").on("click",function(e){if(0<$("#chk_kuwait_delivery").length){if(0==$("#chk_kuwait_delivery").prop("checked"))return $("#chk_kuwait_delivery").focus(),$("#divCheckboxMessage").show(),!1;$("#divCheckboxMessage").hide()}if("0"==$("#itemtotal").val())return location.href=base_url,!1;if($("#formPayment").valid()){var r=$(this),l=$(this).text();$(this).text(pleasewait),$(this).attr("disabled",!0);var a=base_url+"thankyou/process",t=new FormData($("#formPayment")[0]);$.ajax({url:a,type:"POST",data:t,contentType:!1,processData:!1,dataType:"JSON",success:function(e){$.isEmptyObject(e.error)?($(".print-error-msg").css("display","none"),location.href=e.redirect):($(".print-error-msg").css("display","block"),$(".print-error-msg").html(e.error),$(r).text(l),$(r).attr("disabled",!1))},error:function(e,a,t){$(r).text(l),$(r).attr("disabled",!1)}})}e.preventDefault()}),$("#btnProceed").on("click",function(e){if(e.preventDefault(),$("#formAddressCheckout").valid()){var r=$(this),l=$(this).text();$(this).text(pleasewait),$(this).attr("disabled",!0);var a=base_url+"checkout/delivery",t=new FormData($("#formAddressCheckout")[0]);$.ajax({url:a,type:"POST",data:t,contentType:!1,processData:!1,dataType:"JSON",success:function(e){$.isEmptyObject(e.error)?($(".print-error-msg").css("display","none"),location.href=base_url+"payment"):($(".print-error-msg").css("display","block"),$(".print-error-msg").html(e.error),$(r).text(l),$(r).attr("disabled",!1))},error:function(e,a,t){$(r).text(l),$(r).attr("disabled",!1)}})}}),$("#country").on("change",function(e){var t=$("#hdncurrencyrate").val();"Saudi Arabia"==$("#country").val()?$("#divSecurityID").show():$("#divSecurityID").hide(),"Kuwait"==$("#country").val()?(fillArea($("#country").val(),""),$("#address_label").html(additional_label),$(".divItemTotal").hide(),$("#tdGrandTotal").html($("#tdItemTotal").html()),$("#divCity").hide(),$("#divArea,.showStreet").show()):($("#divCity").show(),$("#divArea,.showStreet").hide(),$("#address_label").html(address_label),showLoading(),$.ajax({url:base_url+"areas/get_country",data:{country:$("#country").val()},type:"POST",dataType:"JSON",success:function(e){$(".divItemTotal").show(),$("#tdShippingCharge").html($("#hdncurrencycode").val()+" "+numberFormat(e.shipping_charge*t,3));var a=parseFloat($("#itemtotal").val())+parseFloat(e.shipping_charge*t);$("#tdGrandTotal").html(numberFormat(a,3)),hideLoading()}}))}),$("#countryBill").on("change",function(e){"Kuwait"==$("#countryBill").val()?(fillAreaBill($("#countryBill").val(),""),$("#addressBill_label").html(additional_label),$("#divCityBill").hide(),$("#divAreaBill,.showStreetBill").show()):($("#divCityBill").show(),$("#addressBill_label").html(address_label),$("#divAreaBill,.showStreetBill").hide())}),$("#addNewAddress").on("change",function(e){var a=$("#area"),t=$("#addNewAddress").val();a.empty(),a.append($("<option></option>").val("").html("Select")),showLoading(),$.ajax({url:base_url+"addressbook/getdata",data:{addressid:t},type:"POST",dataType:"JSON",success:function(e){null==e.country&&(e.country="Kuwait"),$("#addressTitle").val(e.title),$("#firstname").val(e.firstname),$("#lastname").val(e.lastname),$("#mobile").val(e.mobile),$("#country").val(e.country).trigger("render.customSelect"),$("#country").trigger("change"),"Kuwait"==e.country?(fillArea(e.country,e.fkareaid),$("#address_label").html(additional_label)):($("#city").val(e.city),$("#address_label").html(address_label)),$("#address").val(e.address),$("#street_number").val(e.street_number),$("#block_number").val(e.block_number),$("#house_number").val(e.house_number),$("#avenue_number").val(e.avenue_number),"Saudi Arabia"==e.country&&$("#securityid").val(e.securityid),hideLoading()}})})});